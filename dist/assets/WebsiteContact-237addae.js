import{u as D,d as W,r as a,s as R,g as B,j as c,b as s}from"./index-50aefbb5.js";import{N as A}from"./index-f767c682.js";import{s as w}from"./sortBy-e64589ef.js";import"./floating-ui.dom.browser.min-e93d2b51.js";import"./_baseIsEqual-557ab863.js";import"./_defineProperty-ddc49374.js";const G=()=>{const C=D(),v=W();a.useEffect(()=>{C(R("Website Contact"))});const[m,x]=a.useState([]),[i,N]=a.useState(""),[d,f]=a.useState([]);a.useState([]);const[g,S]=a.useState(1),y=[10,15,20,30,50,100],[u,j]=a.useState(15),[k,L]=a.useState([]),[l,P]=a.useState({columnAccessor:"id",direction:"asc"});a.useEffect(()=>{E()},[]);const E=async()=>{try{const e={"Content-Type":"application/json",authorization:"Bearer "+localStorage.getItem("accessToken")},t=await B("/v1/websiteContact/getContacts",{},e);x(t),f(t)}catch(e){console.error("Error fetching contacts:",e)}};a.useEffect(()=>{const e=m.filter(t=>{const r=i.toLowerCase(),n=h(t.message);return t.name.toLowerCase().includes(r)||t.email.toLowerCase().includes(r)||t.phone&&t.phone.includes(i)||t.id.toString().includes(i)||n.subject.toLowerCase().includes(r)||n.message.toLowerCase().includes(r)||b(t.created_at).toLowerCase().includes(r)});f(e)},[i,m]),a.useEffect(()=>{let e;l.columnAccessor==="subject"?e=w(d,o=>h(o.message).subject.toLowerCase()):e=w(d,o=>{const p=o[l.columnAccessor];return typeof p=="string"?p.toLowerCase():p});const t=l.direction==="desc"?e.reverse():e,r=(g-1)*u,n=r+u;L(t.slice(r,n))},[g,u,l,d]);const b=e=>new Date(e).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),h=e=>{if(!e)return{subject:"-",message:"-"};const t=e.match(/Subject:\s*(.+?)(?:\n|$)/i),r=e.match(/Message:\s*(.+)/is);let n="-",o=e;return t?(n=t[1].trim(),r?o=r[1].trim():o=e.substring(e.indexOf(t[0])+t[0].length).trim()||e):r&&(o=r[1].trim()),{subject:n,message:o}},M=(e,t)=>{t.stopPropagation(),navigator.clipboard.writeText(e)},T=(e,t)=>{t.stopPropagation(),t.detail===1?navigator.clipboard.writeText(e):t.detail===2&&v("/apps/chat",{state:{phoneNumber:"+91"+e}})};return c("div",{children:[c("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[s("h2",{className:"text-xl",children:"Website Contact"}),c("div",{className:"relative",children:[s("input",{type:"text",placeholder:"Search",className:"form-input py-2 ltr:pr-11 rtl:pl-11 peer",value:i,onChange:e=>N(e.target.value)}),s("button",{type:"button",className:"absolute ltr:right-[11px] rtl:left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-primary",children:c("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s("circle",{cx:"11.5",cy:"11.5",r:"9.5",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"}),s("path",{d:"M18.5 18.5L22 22",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})]})]}),s("div",{className:"mt-5 panel p-0 border-0 overflow-hidden",children:s("div",{className:"datatables",children:s(A,{noRecordsText:"No contacts found",highlightOnHover:!0,className:"whitespace-nowrap table-hover",records:k,columns:[{accessor:"id",title:"ID",sortable:!0,render:({id:e})=>c("strong",{className:"text-info",children:["#",e]})},{accessor:"name",title:"Name",sortable:!0,render:({name:e})=>s("div",{className:"font-semibold",children:e})},{accessor:"email",title:"Email",sortable:!0,render:({email:e})=>s("span",{className:"badge bg-primary cursor-pointer hover:opacity-80",onClick:t=>M(e,t),children:e})},{accessor:"phone",title:"Phone",sortable:!0,render:({phone:e})=>s("span",{className:"badge bg-success cursor-pointer hover:opacity-80",onClick:t=>T(e||"",t),children:e||"-"})},{accessor:"subject",title:"Subject",sortable:!0,render:({message:e})=>s("div",{children:h(e).subject})},{accessor:"created_at",title:"Date",sortable:!0,render:({created_at:e})=>s("div",{className:"whitespace-nowrap",children:b(e)})}],totalRecords:d.length,recordsPerPage:u,page:g,onPageChange:e=>S(e),recordsPerPageOptions:y,onRecordsPerPageChange:j,sortStatus:l,onSortStatusChange:P,minHeight:200,paginationText:({from:e,to:t,totalRecords:r})=>s("span",{className:"ltr:pl-4 rtl:pr-4",children:`Showing ${e} to ${t} of ${r} entries`}),rowExpansion:{allowMultiple:!1,content:({record:e})=>{const t=h(e.message);return s("div",{className:"bg-white-light dark:bg-[#1b2e4b] p-6",children:c("div",{className:"flex gap-4",children:[s("div",{className:"flex-none",children:s("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:c("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s("path",{d:"M2 12C2 8.22876 2 6.34315 3.17157 5.17157C4.34315 4 6.22876 4 10 4H14C17.7712 4 19.6569 4 20.8284 5.17157C22 6.34315 22 8.22876 22 12C22 15.7712 22 17.6569 20.8284 18.8284C19.6569 20 17.7712 20 14 20H10C6.22876 20 4.34315 20 3.17157 18.8284C2 17.6569 2 15.7712 2 12Z",stroke:"currentColor",strokeWidth:"1.5"}),s("path",{opacity:"0.5",d:"M6 8L8.1589 9.79908C9.99553 11.3296 10.9139 12.0949 12 12.0949C13.0861 12.0949 14.0045 11.3296 15.8411 9.79908L18 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})})}),c("div",{className:"flex-1",children:[s("div",{className:"text-sm font-semibold text-primary mb-2",children:"Message"}),s("div",{className:"text-base whitespace-pre-wrap leading-relaxed",children:t.message})]})]})})}}})})})]})};export{G as default};
